<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title></title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style type ="text/javascript">
            #my_canvas{ 
                padding-left: 0;
                padding-right: 0;
                margin-left: auto;
                margin-right: auto;
                display: block;
                width: 800px;
                
            }
        </style>
        <script>
            var ctx;
            var WIDTH;
            var HEIGHT;
            var stage

            var rightP1 = false;
            var leftP1 = false;
            var upP1 = false;
            var downP1 = false;
            var xP1;
            var yP1;
            var rotP1;
            
            var rightP2 = false;
            var leftP2 = false;
            var upP2 = false;
            var downP2 = false;
            var xP2;
            var yP2;
            var rotP2;
            
            var carSpeed;
            var move = true;
            
            var colourTrack = "#101010";
            var colourBack = "#00D000";
            var colourMenu = "#E6F7FF";
            var img = new Image();
            
            var selected;


            function init() {
                ctx = document.getElementById('my_canvas').getContext('2d');
                WIDTH = ctx.canvas.width;
                HEIGHT = ctx.canvas.height;
                stage = 0;

                rotP1 = -(Math.atan(325/400));
                xP1 = 350;
                yP1 = 370;
                
                rotP2 = -(Math.atan(325/400));
                xP2 = 314;
                yP2 = 340;
                
                carSpeed = 4;
                
                selected = 1;
                
                img.src = 'racecar.png';
                
                draw();
            }

            function clear(colour) {
                ctx.fillStyle = colour;
                rect(0, 0, WIDTH, HEIGHT);
            }

            function rect(x, y, w, h) {
                ctx.beginPath();
                ctx.rect(x, y, w, h);
                ctx.closePath();
                ctx.fill();
            }
            
            function drawButton(height, text, selected){
                ctx.beginPath();
                ctx.fillStyle = "#505050";
                ctx.rect((WIDTH/2)-180, height, 360, 60)
                ctx.fill();
                ctx.strokeStyle = "#202020";
                ctx.lineWidth = 4;
                ctx.stroke();
                
                ctx.font = "50px Helvetica Neue";
                if (selected){
                    ctx.fillStyle = "white";
                }else{
                    ctx.fillStyle = "orange";
                }
                ctx.textAlign = "center";
                ctx.fillText(text, WIDTH/2, height+50);
            }

            document.addEventListener('keydown', function(event) {
                if (event.keyCode === 68) {
                    rightP1 = true;
                }
                else if (event.keyCode === 65) {
                    leftP1 = true;
                }
                if (event.keyCode === 87){
                    upP1 = true;
                    menuSelect(-1);
                }else if (event.keyCode === 83){
                    downP1 = true;
                    menuSelect(1);
                }
                
                if (event.keyCode === 39) {
                    rightP2 = true;
                }
                else if (event.keyCode === 37) {
                    leftP2 = true;
                }
                if (event.keyCode === 38){
                    upP2 = true;
                    menuSelect(-1);
                }else if (event.keyCode === 40){
                    downP2 = true;
                    menuSelect(1);
                }
                if (event.keyCode === 13){
                    stage = selected;
                }
                
            });

            document.addEventListener('keyup', function(event) {
                if (event.keyCode === 68) {
                    rightP1 = false;
                }
                else if (event.keyCode === 65) {
                    leftP1 = false;
                }
                if (event.keyCode === 87){
                    upP1 = false;
                }else if (event.keyCode === 83){
                    downP1 = false;
                }
                
                if (event.keyCode === 39) {
                    rightP2 = false;
                }
                else if (event.keyCode === 37) {
                    leftP2 = false;
                }
                if (event.keyCode === 38){
                    upP2 = false;
                }else if (event.keyCode === 40){
                    downP2 = false;
                }
            });

            function updateP1() {
                ctx.save();
                ctx.translate(xP1, yP1);
                ctx.rotate(rotP1);
                if (move){
                    if (leftP1) {
                        rotP1 -= carSpeed/100;
                    } else if (rightP1) {
                        rotP1 += carSpeed/100;
                    }
                    if (upP1){
                        xP1 += carSpeed*Math.cos(rotP1);
                        yP1 += carSpeed*Math.sin(rotP1);
                    }else if (downP1){
                        xP1 -= carSpeed*Math.cos(rotP1);
                        yP1 -= carSpeed*Math.sin(rotP1);
                    }
                }
                ctx.fillStyle = "blue";
                ctx.fillRect(-25, -12, 50, 24);
                ctx.restore();
            }
            
            function updateP2() {
                ctx.save();
                ctx.translate(xP2, yP2);
                ctx.rotate(rotP2);
                if (move){
                    if (leftP2) {
                        rotP2 -= carSpeed/100;
                    } else if (rightP2) {
                        rotP2 += carSpeed/100;
                    }
                    if (upP2){
                        xP2 += carSpeed*Math.cos(rotP2);
                        yP2 += carSpeed*Math.sin(rotP2);
                    }else if (downP2){
                        xP2 -= carSpeed*Math.cos(rotP2);
                        yP2 -= carSpeed*Math.sin(rotP2);
                    }
                }
                ctx.fillStyle = "red";
                ctx.fillRect(-25, -12, 50, 24);
                ctx.restore();
            }
            
            function generateTrack(){
                clear(colourBack);
                //left curved track part
                ctx.beginPath();
                ctx.fillStyle = colourTrack;
                ctx.moveTo(200, 75);
                ctx.bezierCurveTo(-30, 0, -30, 600, 200, 525);
                ctx.fill();
                //left curved track interior definition
                ctx.beginPath();
                ctx.fillStyle = colourBack;
                ctx.moveTo(200, 200);
                ctx.bezierCurveTo(90, 125, 90, 475, 200, 400);
                ctx.fill();
                
                //right curved track part
                ctx.beginPath();
                ctx.fillStyle = colourTrack;
                ctx.moveTo(600, 75);
                ctx.bezierCurveTo(830, 0, 830, 600, 600, 525);
                ctx.fill();
                //right curved track interior definition
                ctx.beginPath();
                ctx.fillStyle = colourBack;
                ctx.moveTo(600, 200);
                ctx.bezierCurveTo(710, 125, 710, 475, 600, 400);
                ctx.fill();
                
                //cross roads
                ctx.beginPath();
                ctx.fillStyle = colourTrack;
                ctx.moveTo(200, 75);
                ctx.lineTo(600, 400);
                ctx.lineTo(600, 525);
                ctx.lineTo(200, 200);
                ctx.fill();
                
                ctx.beginPath();
                ctx.moveTo(200, 400);
                ctx.lineTo(600, 75);
                ctx.lineTo(600, 200);
                ctx.lineTo(200, 525);
                ctx.fill();
                
                //lines on road
                ctx.beginPath();
                ctx.moveTo(322, 300);
                ctx.lineWidth = 6;
                ctx.lineTo(400, 363);
                ctx.strokeStyle = "#909090";
                ctx.stroke();
                
                ctx.beginPath();
                ctx.moveTo(400, 237);
                ctx.lineWidth = 6;
                ctx.lineTo(478, 300);
                ctx.strokeStyle = "#909090";
                ctx.stroke();
                
            }
            
            function updateMenuButtons(){
                if (selected === 1){
                    drawButton(380, "Start", true);
                    drawButton(450, "Instructions", false);
                    drawButton(520, "Credits", false);
                }else if (selected === 2){
                    drawButton(380, "Start", false);
                    drawButton(450, "Instructions", true);
                    drawButton(520, "Credits", false);
                }else if (selected === 3){
                    drawButton(380, "Start", false);
                    drawButton(450, "Instructions", false);
                    drawButton(520, "Credits", true);
                }else if (selected > 3){
                    selected = 1;
                    drawButton(380, "Start", false);
                    drawButton(450, "Instructions", false);
                    drawButton(520, "Credits", false);
                }else if (selected < 1){
                    selected = 3;
                    drawButton(380, "Start", false);
                    drawButton(450, "Instructions", false);
                    drawButton(520, "Credits", false);
                }
            }
            
            function updateMenuLabel(){
                ctx.drawImage(img, WIDTH/2-(img.width/2), 65);
        
                ctx.beginPath();
                ctx.fillStyle = "#505050";
                ctx.strokeStyle = "#202020";
                ctx.lineWidth = 4;
                ctx.rect(WIDTH/2-300, -20, 600, 80);
                ctx.fill();
                ctx.stroke();
        
                ctx.font = "50px Helvetica";
                ctx.fillStyle = "orange";
                ctx.textAlign = "center";
                ctx.fillText("Racecar Simulator 2016", WIDTH/2, 50);
                
                
                
            }
            
            function menuSelect(direction){
                selected += direction;
            }

            function draw() {
                if (stage === 0){
                    clear(colourMenu);
                    updateMenuLabel();
                    updateMenuButtons();
                    
                }else if (stage === 1){
                    generateTrack();
                    updateP1();
                    updateP2();
                }else if (stage === 2){
                    clear(colourMenu);
                }else if (stage === 3){
                    clear(colourMenu);
                }
                window.requestAnimationFrame(draw);
            }

            window.onload = init;
        </script>
    </head>
    <body>
        <div align="center"><canvas id="my_canvas" width="800" height="600" ></canvas></div>
        
    </body>
</html>
